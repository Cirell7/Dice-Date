{% extends "core/base1.html" %}
{% load static %}

{% block extra_style %}
  <link rel="stylesheet" href="{% static 'dashboard/css/messages.css' %}" />
{% endblock %}

{% block main %}
<div class="container">
    <div class="thread-header">
        <a href="{% url 'messages_list' %}" class="back-btn">← Назад</a>
        <div class="user-info">
            {% if other_user.profile.photo %}
                <img src="{{ other_user.profile.photo.url }}" alt="{{ other_user.username }}">
            {% else %}
                <div class="default-avatar">{{ other_user.username|first|upper }}</div>
            {% endif %}
            <h2>{{ other_user.username }}</h2>
        </div>
    </div>

    <div class="messages-container">
        {% for message in messages %}
        <div class="message {% if message.sender == request.user %}sent{% else %}received{% endif %}">
            <div class="message-content">
                <p>{{ message.content }}</p>
                <small>{{ message.timestamp|date:"d.m.Y H:i" }}</small>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="message-form-container">
        <form method="post" class="message-form">
            {% csrf_token %}
            <div class="input-group">
                <textarea name="content" placeholder="Напишите сообщение..." required></textarea>
                <button type="submit" class="btn btn-primary">Отправить</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}